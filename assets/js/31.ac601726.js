(window.webpackJsonp=window.webpackJsonp||[]).push([[31],{419:function(t,s,a){"use strict";a.r(s);var n=a(52),e=Object(n.a)({},(function(){var t=this,s=t.$createElement,a=t._self._c||s;return a("ContentSlotsDistributor",{attrs:{"slot-key":t.$parent.slotKey}},[a("h1",{attrs:{id:"vue-源码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#vue-源码"}},[t._v("#")]),t._v(" VUE 源码")]),t._v(" "),a("h3",{attrs:{id:"探讨内容"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#探讨内容"}},[t._v("#")]),t._v(" 探讨内容")]),t._v(" "),a("ul",[a("li",[t._v("Vue架构概览")]),t._v(" "),a("li",[t._v("双向数据绑定&SetState原理")]),t._v(" "),a("li",[t._v("Vue2 Virtual-dom")]),t._v(" "),a("li",[t._v("Vue2 DOM Diff算法解析")]),t._v(" "),a("li",[t._v("Vue2整体解析流程")]),t._v(" "),a("li",[t._v("Vue运行时优化")]),t._v(" "),a("li",[t._v("再见Vue~前端技术框架选型")])]),t._v(" "),a("h2",{attrs:{id:"源码结构"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#源码结构"}},[t._v("#")]),t._v(" 源码结构")]),t._v(" "),a("p",[t._v("源码下载地址 "),a("a",{attrs:{href:"https://github.com/vuejs/vue",target:"_blank",rel:"noopener noreferrer"}},[t._v("源码地址"),a("OutboundLink")],1)]),t._v(" "),a("p",[a("img",{attrs:{src:"vue_1.png",alt:"源码目录"}})]),t._v(" "),a("p",[t._v("首先，第一层目录")]),t._v(" "),a("p",[t._v("1.benchmarks 跑分。测试性能测试")]),t._v(" "),a("p",[t._v("2.dist 打包出的代码。")]),t._v(" "),a("p",[t._v("3.examples 例子。")]),t._v(" "),a("p",[t._v("4.flow 类型规范。一个框架")]),t._v(" "),a("p",[t._v("5.packages 用lerna框架做出来，多包管理工具。 eg:vue SSR->vue-server-renderer->js->VM node")]),t._v(" "),a("p",[t._v("6.scripts 打包脚本。")]),t._v(" "),a("p",[t._v("7.src 逻辑代码，核心代码。")]),t._v(" "),a("p",[t._v("8.test 测试。")]),t._v(" "),a("p",[t._v("9.types flow定义的ts。")]),t._v(" "),a("p",[t._v("在看核心代码前，先分析一下dist中为什么打包出来很多不一样的vue。")]),t._v(" "),a("ul",[a("li",[t._v("Runtime only (vue运行时)")]),t._v(" "),a("li",[t._v("Runtime+compiler (在线编译) 通过js编译成with(),with转成js render()")]),t._v(" "),a("li",[t._v("还有不同规范")])]),t._v(" "),a("p",[a("strong",[t._v("src 核心代码结构")])]),t._v(" "),a("p",[a("img",{attrs:{src:"vue_2.png",alt:"src"}})]),t._v(" "),a("p",[t._v("1./compiler 目录，模板编译打包的过程；(离线编译) vue->js。eg："),[t._v("{i}")],t._v(" //浏览器不认识，所以要把组件编译成js\nhttps://vue-template-explorer.netlify.app/")],2),t._v(" "),a("p",[t._v("2./core ⽬录是 Vue.js 的核⼼(也是后面的重点)；")]),t._v(" "),a("p",[t._v("3./platforms ⽬录是针对核⼼模块的 ‘平台’ 模块，")]),t._v(" "),a("p",[t._v("4.platforms 目录下有 web、 weex ⽬录。 web 目录下有对应的 /compiler、 /runtime、\n/server、 /util目录；（这里的compiler是在线编译，外面的compiler是离线编译）")]),t._v(" "),a("p",[t._v("5./server 目录是处理服务端渲染；")]),t._v(" "),a("p",[t._v("6./sfc 目录处理单⽂件 .vue；")]),t._v(" "),a("p",[t._v("7./shared 目录提供全局用到的工具")]),t._v(" "),a("p",[t._v("结论：Vue.js 的组成是由 core + 对应的 ‘平台’ 补充代码构成（独立构建和运行时构建\n只是 platforms 下 web 平台的两种选择）。\n"),a("img",{attrs:{src:"vue_3.png",alt:"core"}})]),t._v(" "),a("h2",{attrs:{id:"双向数据绑定"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#双向数据绑定"}},[t._v("#")]),t._v(" 双向数据绑定")]),t._v(" "),a("p",[a("strong",[t._v("双向绑定（响应式原理）所涉及到的技术")])]),t._v(" "),a("ul",[a("li",[t._v("1.Object.defineProperty")]),t._v(" "),a("li",[t._v("2.Observer")]),t._v(" "),a("li",[t._v("3.Watcher")]),t._v(" "),a("li",[t._v("4.Dep")]),t._v(" "),a("li",[t._v("5.Directive\n"),a("img",{attrs:{src:"vue_4.png",alt:"双向数据绑定"}})])]),t._v(" "),a("h3",{attrs:{id:"_1-object-defineproperty"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_1-object-defineproperty"}},[t._v("#")]),t._v(" 1.Object.defineProperty")]),t._v(" "),a("p",[a("img",{attrs:{src:"vue_5.png",alt:"defineProperty"}}),t._v(" "),a("strong",[t._v("总结")])]),t._v(" "),a("div",{staticClass:"language-yml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-yml"}},[a("code",[t._v("<span"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("a"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("</span"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")]),t._v(" getter "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")]),t._v(" watcher "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")]),t._v(" dep(并且返回数据渲染)"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("a"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("watcher"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\n                   "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")]),t._v(" setter "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")]),t._v("dep "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("a"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("watcher"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")]),t._v(" <span"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("a"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("</span"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br")])]),a("p",[a("img",{attrs:{src:"vue_9.png",alt:"defineProperty"}}),t._v("\nsetter 触发消息到 Watcher watcher帮忙告诉 Directive 更新 DOM，DOM中修改了数据也会通知Watcher，watcher帮忙修改数据。")]),t._v(" "),a("h3",{attrs:{id:"_2-observer"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_2-observer"}},[t._v("#")]),t._v(" 2.Observer")]),t._v(" "),a("p",[a("img",{attrs:{src:"vue_6.png",alt:"observer"}}),t._v(" "),a("img",{attrs:{src:"vue_7.png",alt:"observer"}}),t._v(" "),a("strong",[t._v("src/core/observer/index.js")]),t._v(" ,"),a("strong",[t._v("src/core/observer/array.js")])]),t._v(" "),a("p",[a("strong",[t._v("Observer主要处理过程：")])]),t._v(" "),a("p",[t._v("Observer会观察两种类型的数据，Object 与 Array")]),t._v(" "),a("p",[t._v("对于Array类型的数据，由于 JavaScript 的限制， Vue 不能检测变化,会先重写操作数组\n的原型方法，重写后能达到两个目的，")]),t._v(" "),a("p",[t._v("1.当数组发生变化时，触发 notify")]),t._v(" "),a("p",[t._v("如果是 push，unshift，splice 这些添加新元素的操作，则会使用observer观察新添加的\n数据")]),t._v(" "),a("p",[t._v("重写完原型方法后，遍历拿到数组中的每个数据 使用observer观察它")]),t._v(" "),a("p",[t._v("2.而对于Object类型的数据，则遍历它的每个key，使用 defineProperty 设置 getter 和\nsetter，当触发getter的时候，observer则开始收集依赖，而触发setter的时候，observe\n则触发notify。\n"),a("img",{attrs:{src:"vue_8.png",alt:"observer"}}),t._v(" "),a("strong",[t._v("总结observer")])]),t._v(" "),a("div",{staticClass:"language-yml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-yml"}},[a("code",[t._v("observer(data) "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")]),t._v(" 是否是数组\n                 是"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")]),t._v("重写数组\n   \t\t\t      1.arr="),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("._proto_=ArrayMethed"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n   \t\t\t\t  ArrayMethed"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")]),t._v("继承了"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")]),t._v("数组方法（拦截 def）\n                 否"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")]),t._v("this.walk"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")]),t._v("object.key("),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(")"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("-")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(">")]),t._v("遍历所有的key(object.defineProperty)\n   \t\t\t  object.defineProperty(\n   \t\t\t     get"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("//把对应的依赖收集到电话本Dep.push()\n   \t\t\t\t set"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),t._v("//分发，触发所有依赖 遍历Dep电话本\n   \t\t\t  )\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br")])]),a("h3",{attrs:{id:"_3-watcher"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_3-watcher"}},[t._v("#")]),t._v(" 3.Watcher")]),t._v(" "),a("p",[a("strong",[t._v("src/core/observer/watcher.js")])]),t._v(" "),a("p",[t._v("Watcher 是将模板和 Observer 对象结合在一起的纽带。Watcher 是订阅者模式中的订阅者。Watcher 的两\n个参数： expOrFn 最终会被转换为 getter 函数， cb 是更新时执行的回调。依赖收集的入口就是get函数。\n"),a("img",{attrs:{src:"vue_10.png",alt:"watcher"}}),t._v("\ngetter 函数是用来连接监控属性与 Watcher 的关键。\n"),a("img",{attrs:{src:"vue_11.png",alt:"watcher"}})]),t._v(" "),a("h3",{attrs:{id:"_4-dep"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_4-dep"}},[t._v("#")]),t._v(" 4.Dep")]),t._v(" "),a("p",[a("strong",[t._v("src/core/observer/dep.js")]),t._v(" "),a("img",{attrs:{src:"vue_12.png",alt:"dep"}})]),t._v(" "),a("h3",{attrs:{id:"_5-directive"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#_5-directive"}},[t._v("#")]),t._v(" 5.Directive")]),t._v(" "),a("p",[a("img",{attrs:{src:"vue_13.png",alt:"directive"}}),t._v("\nvue内置了这么多的指令，这些指令都会抛出两个接口bind 和 update，这两个接口的作用是，编译的最后一步是执行所有用到的指令的bind方\n法，而 update 方法则是当watcher 触发 update 时，Directive会触发指令的update方法")]),t._v(" "),a("p",[t._v("observe -> 触发setter ->")]),t._v(" "),a("p",[t._v("watcher -> 触发update ->")]),t._v(" "),a("p",[t._v("Directive -> 触发update ->")]),t._v(" "),a("p",[t._v("指令")]),t._v(" "),a("h3",{attrs:{id:"实践"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#实践"}},[t._v("#")]),t._v(" 实践")]),t._v(" "),a("p",[t._v("手写实现数据双向绑定，"),a("a",{attrs:{href:"https://github.com/wumao016/myVue",target:"_blank",rel:"noopener noreferrer"}},[t._v("代码地址"),a("OutboundLink")],1)]),t._v(" "),a("blockquote",[a("p",[t._v("其他的一些代码解析")])]),t._v(" "),a("p",[a("strong",[t._v("1.vue.use的实现")]),t._v(" "),a("strong",[t._v("src/core/global-api/use.js")]),t._v(" "),a("img",{attrs:{src:"vue_14.png",alt:"use"}})]),t._v(" "),a("h2",{attrs:{id:"vue-setstate"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#vue-setstate"}},[t._v("#")]),t._v(" Vue SetState")]),t._v(" "),a("p",[t._v("总结")]),t._v(" "),a("p",[t._v("1.Batch Update")]),t._v(" "),a("p",[t._v("2.Transaction对一个函数进行包装，让React有机会在一个函数执行前和执行后运行特定的逻辑，从\n而完成对整个Batch Update流程的控制。")]),t._v(" "),a("p",[t._v("简单的说就是在要执行的函数中用事务包裹起来，在函数执行前加入initialize阶段，函数执行，最后\n执行close阶段。那么Batch Update中")]),t._v(" "),a("p",[t._v("在事件initialize阶段，一个update queue被创建。在事件中调用setState方法时，状态不会被立即调\n用，而是被push进Update queue中。")]),t._v(" "),a("p",[t._v("函数执行结束调用事件的close阶段，Update queue会被flush，这事新的状态才会被应用到组件上并开\n始后续的Virtual DOM更新，biff算法来对model更新。")]),t._v(" "),a("p",[t._v("3.当model被修改时，对应的watcher会被推入Update queue， 与此同时还会在异步队列中添加一个task用于flush\n当前的Update queue。")]),t._v(" "),a("p",[t._v("这样一来，当前的task中的其他watcher会被推进同一个Update queue中。当前task执行结束后，异步队列下一个\ntask执行，update queue\n会被 flush，并进行后续的更新操作。\n为了让 flush 动作能在当前 Task 结束后尽可能早的开始，Vue 会优先尝试将任务 micro-task 队列，具体来说，\n在浏览器环境中 Vue 会优\n先尝试使用 MutationObserver API 或 Promise，如果两者都不可用，则 fallback 到 setTimeout。\n对比两个框架可以发现 React 基于 Transition 实现的 Batch Query 是一个不依赖语言特性的通用模式，因此有\n更稳定可控的表现，但缺点是无法完全覆盖所有情况")]),t._v(" "),a("h2",{attrs:{id:"virtual-dom"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#virtual-dom"}},[t._v("#")]),t._v(" Virtual-dom")]),t._v(" "),a("p",[t._v("DOM操作很慢是两个原因，一个是本身操作就不快，第\n二是我们（还有很多框架）处理dom的方式很慢，Virtual\nDom解决了我们这些愚蠢的程序员对Dom的低劣操作，它让我\n们不需要进行Dom操作，而是将希望展现的最终结果告诉\nReact(vue)，React(vue)通过一个简化的Dom即Virtual dom进行\nrender，当你试图改变显示内容时，新生成的Virtual Dom会\n与现在的Virtual dom对比，通过diff算法找到区别，这些操作\n都是在快速的js中完成的，最后对实际Dom进行最小的Dom操\n作来完成效果，这就是Virtual Dom的概念。\nrective(descriptor, this, node, host, scope, frag)")]),t._v(" "),a("blockquote",[a("p",[t._v("Virtual-dom")])]),t._v(" "),a("p",[t._v("‘Virtual-dom’是一系列的模块集合，用来提供声明式的DOM渲染。来看一个简单的 DOM 片段.\n本质上就是在 JS 和 DOM 之间做了一个缓存。可以类比 CPU 和硬盘，既然硬盘这么慢，我\n们就在它们之间加个缓存：既然 DOM 这么慢，我们就在它们 JS 和 DOM 之间加个缓存。\nCPU（JS）只操作内存（Virtual DOM），最后的时候再把变更写入硬盘（DOM）。\n"),a("img",{attrs:{src:"vue_15.png",alt:"dom"}}),t._v(" "),a("strong",[t._v("VIRTUAL-DOM->CORE/VDOM/CREATE-ELEMENT.JS")]),t._v(" "),a("img",{attrs:{src:"vue_16.png",alt:"dom"}})]),t._v(" "),a("h2",{attrs:{id:"vue2整体解析流程"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#vue2整体解析流程"}},[t._v("#")]),t._v(" Vue2整体解析流程")]),t._v(" "),a("p",[a("img",{attrs:{src:"vue_17.png",alt:"生命周期"}}),t._v(" "),a("img",{attrs:{src:"vue_18.png",alt:"生命周期"}}),t._v("\n2.0 的版本中这一块有很大的改动，1.0 的版本中 Vue 使用的是 DocumentFragment 来进行模板解\n析，而 2.0 中作者采用的 John Resig 的 HTML Parser 将模板解析成可直接执行的 render 函数，这是\n模板预编译和服务端渲染（SSR）的前提；")]),t._v(" "),a("h2",{attrs:{id:"vue运行时优化"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#vue运行时优化"}},[t._v("#")]),t._v(" Vue运行时优化")]),t._v(" "),a("p",[a("img",{attrs:{src:"vue_19.png",alt:"优化"}}),t._v(" "),a("img",{attrs:{src:"vue_20.png",alt:"优化"}})]),t._v(" "),a("h2",{attrs:{id:"vue3源码"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#vue3源码"}},[t._v("#")]),t._v(" Vue3源码")]),t._v(" "),a("p",[t._v("源码地址"),a("a",{attrs:{href:"https://github.com/vuejs/vue-next",target:"_blank",rel:"noopener noreferrer"}},[t._v("源码地址"),a("OutboundLink")],1)]),t._v(" "),a("p",[a("strong",[t._v("区别")])]),t._v(" "),a("p",[t._v("1.tempalte：vue2->正则,   vue3->词法分析->语法分析->AST")]),t._v(" "),a("p",[t._v("2.核心逻辑 object.defineproperty->proxy")]),t._v(" "),a("p",[a("strong",[t._v("提升")])]),t._v(" "),a("p",[t._v("1.性能 模版解析的优化，组件优化，虚拟dom优化")]),t._v(" "),a("p",[t._v("2.tree shaking vue2打包出来 -》vue.min.js vue.runtime.min.js, vue3 -》数据响应处理，模版解析处理，端处理。")]),t._v(" "),a("p",[t._v("3.composition API")]),t._v(" "),a("p",[t._v("4.ts proxy")]),t._v(" "),a("h3",{attrs:{id:"模版解析"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#模版解析"}},[t._v("#")]),t._v(" 模版解析")]),t._v(" "),a("p",[t._v("官方模版解析"),a("a",{attrs:{href:"https://vue-next-template-explorer.netlify.app/",target:"_blank",rel:"noopener noreferrer"}},[t._v("地址"),a("OutboundLink")],1)]),t._v(" "),a("p",[a("strong",[t._v("词法分析")])]),t._v(" "),a("p",[t._v("通过一个规范把模版分析，"),a("a",{attrs:{href:"https://github.com/antlr/grammars-v4",target:"_blank",rel:"noopener noreferrer"}},[t._v("词法分析参考规则"),a("OutboundLink")],1),t._v("，解析成tonken，再经过语法分析，就会形成AST")]),t._v(" "),a("h3",{attrs:{id:"数据双向响应"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#数据双向响应"}},[t._v("#")]),t._v(" 数据双向响应")]),t._v(" "),a("p",[a("strong",[t._v("proxy")])]),t._v(" "),a("p",[t._v("vue3的数据双向响应用的是proxy，proxy自身有一些缺点：")]),t._v(" "),a("p",[t._v("1.数据挪动 多次触发。")]),t._v(" "),a("div",{staticClass:"language-yml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-yml"}},[a("code",[t._v("var data="),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("3")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v(";\nvar p=new Proxy(data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\tget(target"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("receiver)"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\tconsole.log('get value'"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("key);\n\t\treturn Reflect.get(target"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("receiver)\n\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\tset(target"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("receiver)"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\tconsole.log('set value'"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("key);\n\t\treturn Reflect.set(target"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("receiver)\n\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(")\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br")])]),a("p",[t._v("2.不能拦截深层次的对象数据（vue3的处理是，对于深层次嵌套的对象，一开始没有递归，是在获取的时候判断是否是对象，再处理成为响应式数据）。")]),t._v(" "),a("div",{staticClass:"language-yml line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-yml"}},[a("code",[t._v("var data="),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\tfoo"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\tbar"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(":")]),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("1")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\nvar p=reactive(data)\nfunction reactive(data)"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\treturn new Proxy(data"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\tget(target"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("receiver)"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\tconsole.log('get value'"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("key);\n\t\t\tvar res=Reflect.get(target"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("receiver)\n\t\t\tif(typeof res=='object')"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\t\treturn reactive(res)\n\t\t\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\t\t\treturn res\n\t\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n\t\tset(target"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("receiver)"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n\t\t\tconsole.log('set value'"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("key);\n\t\t\treturn Reflect.set(target"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("key"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("value"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("receiver)\n\t\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(")\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br"),a("span",{staticClass:"line-number"},[t._v("18")]),a("br"),a("span",{staticClass:"line-number"},[t._v("19")]),a("br"),a("span",{staticClass:"line-number"},[t._v("20")]),a("br"),a("span",{staticClass:"line-number"},[t._v("21")]),a("br"),a("span",{staticClass:"line-number"},[t._v("22")]),a("br")])]),a("blockquote",[a("p",[t._v("vue3 packages目录分析")])]),t._v(" "),a("ul",[a("li",[t._v("compiler-core -》编译器")]),t._v(" "),a("li",[t._v("compiler-dom -》针对浏览器而言的编译器")]),t._v(" "),a("li",[t._v("reactivity -》相当于vue2的observer -》数据响应系统")]),t._v(" "),a("li",[t._v("runtime-core -》运行时")]),t._v(" "),a("li",[t._v("runtime-dom -》专门针对于浏览器的运行时的")]),t._v(" "),a("li",[t._v("server-renderer -》服务端渲染")])]),t._v(" "),a("p",[a("strong",[t._v("reactivity")])]),t._v(" "),a("p",[t._v("数据响应架构\n"),a("img",{attrs:{src:"vue_21.png",alt:"架构"}})]),t._v(" "),a("h3",{attrs:{id:"vue3与vue2比较"}},[a("a",{staticClass:"header-anchor",attrs:{href:"#vue3与vue2比较"}},[t._v("#")]),t._v(" vue3与vue2比较")]),t._v(" "),a("p",[a("strong",[t._v("vue2 options API")])]),t._v(" "),a("ul",[a("li",[t._v("beforeCreate")]),t._v(" "),a("li",[t._v("created")]),t._v(" "),a("li",[t._v("beforeMount")]),t._v(" "),a("li",[t._v("mounted")]),t._v(" "),a("li",[t._v("beforeUpdate")]),t._v(" "),a("li",[t._v("updated")]),t._v(" "),a("li",[t._v("beforeDestory")]),t._v(" "),a("li",[t._v("destoryed")]),t._v(" "),a("li",[t._v("errorCaptured")])]),t._v(" "),a("p",[a("strong",[t._v("vue3 composition API")])]),t._v(" "),a("ul",[a("li",[t._v("setup()")]),t._v(" "),a("li",[t._v("onBeforeMount")]),t._v(" "),a("li",[t._v("onMounted")]),t._v(" "),a("li",[t._v("onBeforeUpdate")]),t._v(" "),a("li",[t._v("onUpdated")]),t._v(" "),a("li",[t._v("onBeforeUnmount")]),t._v(" "),a("li",[t._v("onUnmounted")]),t._v(" "),a("li",[t._v("onErrorCaptured")])]),t._v(" "),a("p",[a("strong",[t._v("vue2 basic")])]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("new")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Vue")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  el"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"#app"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  template"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token template-string"}},[a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('\n    <div>\n        <div>Count is: {{ this.count }}, double is: {{ this.double }}</div>\n        <button @click="increment">Add</button>\n    </div>\n')]),a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  data"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    count"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  computed"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("double")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("count "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  methods"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("increment")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("count"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//html里直接引入")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("script src"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"./js/setup_v2.js"')]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("script"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br"),a("span",{staticClass:"line-number"},[t._v("18")]),a("br"),a("span",{staticClass:"line-number"},[t._v("19")]),a("br"),a("span",{staticClass:"line-number"},[t._v("20")]),a("br"),a("span",{staticClass:"line-number"},[t._v("21")]),a("br"),a("span",{staticClass:"line-number"},[t._v("22")]),a("br"),a("span",{staticClass:"line-number"},[t._v("23")]),a("br"),a("span",{staticClass:"line-number"},[t._v("24")]),a("br"),a("span",{staticClass:"line-number"},[t._v("25")]),a("br")])]),a("p",[a("strong",[t._v("vue3 basic")])]),t._v(" "),a("div",{staticClass:"language-js line-numbers-mode"},[a("pre",{pre:!0,attrs:{class:"language-js"}},[a("code",[a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" reactive"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v(" computed "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Vue"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" App "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  template"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token template-string"}},[a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('\n        <div>Count is: {{ state.count }}, double is: {{ state.double }}</div>\n        <button @click="increment">Add</button>\n    ')]),a("span",{pre:!0,attrs:{class:"token template-punctuation string"}},[t._v("`")])]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("setup")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n    console"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("log")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"🐻"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("this")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\t"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//window")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 创建响应数据")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" state "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("reactive")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      count"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("0")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      double"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(":")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("computed")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=>")]),t._v(" state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("count "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("*")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token number"}},[t._v("2")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    \n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("function")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("increment")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("count"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("++")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("return")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n      state"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n      increment"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(",")]),t._v("\n    "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n\n"),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//html里")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),t._v("script"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("const")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v(" createApp "),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v(" "),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" Vue"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token comment"}},[t._v("// 最新alpha版本中写法变了")]),t._v("\n  "),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("createApp")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("App"),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),a("span",{pre:!0,attrs:{class:"token function"}},[t._v("mount")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),a("span",{pre:!0,attrs:{class:"token string"}},[t._v('"#app"')]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),a("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(";")]),t._v("\n"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("<")]),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("script"),a("span",{pre:!0,attrs:{class:"token operator"}},[t._v(">")]),t._v("\n")])]),t._v(" "),a("div",{staticClass:"line-numbers-wrapper"},[a("span",{staticClass:"line-number"},[t._v("1")]),a("br"),a("span",{staticClass:"line-number"},[t._v("2")]),a("br"),a("span",{staticClass:"line-number"},[t._v("3")]),a("br"),a("span",{staticClass:"line-number"},[t._v("4")]),a("br"),a("span",{staticClass:"line-number"},[t._v("5")]),a("br"),a("span",{staticClass:"line-number"},[t._v("6")]),a("br"),a("span",{staticClass:"line-number"},[t._v("7")]),a("br"),a("span",{staticClass:"line-number"},[t._v("8")]),a("br"),a("span",{staticClass:"line-number"},[t._v("9")]),a("br"),a("span",{staticClass:"line-number"},[t._v("10")]),a("br"),a("span",{staticClass:"line-number"},[t._v("11")]),a("br"),a("span",{staticClass:"line-number"},[t._v("12")]),a("br"),a("span",{staticClass:"line-number"},[t._v("13")]),a("br"),a("span",{staticClass:"line-number"},[t._v("14")]),a("br"),a("span",{staticClass:"line-number"},[t._v("15")]),a("br"),a("span",{staticClass:"line-number"},[t._v("16")]),a("br"),a("span",{staticClass:"line-number"},[t._v("17")]),a("br"),a("span",{staticClass:"line-number"},[t._v("18")]),a("br"),a("span",{staticClass:"line-number"},[t._v("19")]),a("br"),a("span",{staticClass:"line-number"},[t._v("20")]),a("br"),a("span",{staticClass:"line-number"},[t._v("21")]),a("br"),a("span",{staticClass:"line-number"},[t._v("22")]),a("br"),a("span",{staticClass:"line-number"},[t._v("23")]),a("br"),a("span",{staticClass:"line-number"},[t._v("24")]),a("br"),a("span",{staticClass:"line-number"},[t._v("25")]),a("br"),a("span",{staticClass:"line-number"},[t._v("26")]),a("br"),a("span",{staticClass:"line-number"},[t._v("27")]),a("br"),a("span",{staticClass:"line-number"},[t._v("28")]),a("br"),a("span",{staticClass:"line-number"},[t._v("29")]),a("br"),a("span",{staticClass:"line-number"},[t._v("30")]),a("br"),a("span",{staticClass:"line-number"},[t._v("31")]),a("br")])]),a("p",[a("strong",[t._v("vue3 setup")])]),t._v(" "),a("ul",[a("li",[t._v("1.setup是一个新的组件选项，也是其他API的入口。\n也就是说，你所有的操作都将在setup函数内部定义和执行，\nVue3.0也将用函数代替Vue2.x的类也就是new Vue()")]),t._v(" "),a("li",[t._v("2.setup 第一个参数是props,这里的props和Vue2.x中的props一致。")]),t._v(" "),a("li",[t._v("3.何时调用？setup是在一个组件实例被创建时，初始化了 props 之后调用，\n其实就是取代了Vue2.x的careted和beforeCreate。")]),t._v(" "),a("li",[t._v("4.setup返回一个对象，对象中的属性将直接暴露给模板渲染的上下文。\n而在Vue2.x中，你定义的属性都会被Vue内部无条件暴露给模板渲染上下文。")]),t._v(" "),a("li",[t._v("5.setup第二个参数(context)提供一个上下文对象，这个上下文对象提供一个可选的属性列表，和Vue2.x中挂载在this上的属性列表一致。context具有与this.$attrs，this.$slots，this.$emit，this.$parent，this.$root对应的属性（属性，插槽，emit，parent，root）。")])]),t._v(" "),a("p",[a("code",[t._v("1.props对比Vue2.x主要要注意的地方 (1)Vue2.x中props绑定在this上，我们可以通过this.props.propsName获取对应的值， Vue3.0后Props将变成setup的第一个参数,而setup也是在初始化props之后才被调用。有点像某act的感觉 (2)类型定义的时候，仍然可以像Vue2.x一样，同时也支持TS (3)props 对象是响应式的 —— 它可以被当作数据源去观测，当后续 props 发生变动时它也会被框架内部同步更新。 但对于用户代码来说，它是不可修改的（会导致警告）")])]),t._v(" "),a("p",[a("strong",[t._v("vue3 rective")])]),t._v(" "),a("ul",[a("li",[t._v("vue2里没有rective，相当于date")]),t._v(" "),a("li",[t._v("vue3 数据监听函数")]),t._v(" "),a("li",[t._v("1.reactive函数接收一个对象作为参数，返回这个对象的响应式代理，等价Vue2.x的Vue.observable()")]),t._v(" "),a("li",[t._v("2.对比Vue2.x的observable()，组件实例在初始化的时候会将 data 整个对象变为可观察对象，\n通过递归的方式给每个 Key 使用 Object.defineProperty 加上 getter 和 settter ，\n如果是数组就重写代理数组对象的七个方法。虽然给我们带来的便利，但是在大型项目上来说，性能开销就很大了。\nVue3.0之后不再将主动监听所有的数据，而是将选择权给你，实例在初始化时不需要再去递归 data 对象了，\n从而降低了组件实例化的时间。")])]),t._v(" "),a("p",[a("strong",[t._v("vue3 ref")])]),t._v(" "),a("ul",[a("li",[a("p",[t._v("ref接收一个原始值，返回一个包装对象，\n包装对象具有.value属性。通过.value访问这个值。")])]),t._v(" "),a("li",[a("p",[t._v("被 ref 方法包裹后的 元素 就变成了一个代理对象。")])]),t._v(" "),a("li",[a("p",[t._v("一般而言，这里的元素参数指 基本元素 或者称之为 inner value，\n如：number, string, boolean,null,undefied 等，object 一般不使用 ref，而是使用上文的 reactive。\n也就是说 ref 一般适用于某个元素的；而 reactive 适用于一个对象。\nref 也就相当于把单个元素转换成一个 reactive 对象了，对象默认的键值名是：value。\n"),a("strong",[t._v("ref 和 reactive区别")])])]),t._v(" "),a("li",[a("p",[t._v("其实ref相当于reactive的小弟，ref背后也是通过reactive实现的，唯一的区别是ref返回的是包装对象\nconst count = ref(0)  等价 const count = reactive({value:0})")])]),t._v(" "),a("li",[a("p",[t._v("在setup函数中，如果通过结构返回ref和reactive,那么在模板渲染上下文中，获取不到他们的响应式变化。\n因为解构他们就意味着copy了他们的引用。所以尽量不要用解构去返回一个你期望响应式的数据")])])]),t._v(" "),a("p",[a("strong",[t._v("vue3 computed")])]),t._v(" "),a("ul",[a("li",[t._v("3.0中，computed 被抽成一个API，直接从vue中获取，\n而Vue2.x中，computed是一个对象，在对象中定义一个个computed")])]),t._v(" "),a("p",[a("strong",[t._v("vue3 watch")])]),t._v(" "),a("ul",[a("li",[a("p",[t._v("watch() API 提供了基于观察状态的变化来执行副作用的能力。")])]),t._v(" "),a("li",[a("p",[t._v("watch(source,cb,options?)")]),t._v(" "),a("p",[t._v("watch() 接收三个参数")]),t._v(" "),a("div",{staticClass:"language- extra-class"},[a("pre",[a("code",[t._v("  1.第一个参数被称作 “数据源”，它可以是：\n  \n      一个返回任意值的函数\n  \t\n      一个包装对象\n  \t\n      一个包含上述两种数据源的数组\n  \t\n      source：可以是getter函数，值包装器或包含上述两种类型的数组（如果要查看多个源）\n  \t\n  2.第二个参数是回调函数。回调函数只有当数据源发生变动时才会被触发：\n  \n      callback：是类似于Vue2 watcher处理程序的函数，带有2个参数：newVal，oldVal。\n  \t\n      每个参数都可以是一个数组(用于观察多个源): [newVal1，newVal2，... newValN]，[oldVal1，oldVal2，... oldValN]\n  \n  3.第三个可选参数options,\n  \n      deep 深度监听\n  \t\n          类型: boolean  default :false\n          和Vue2.x行为一致，都是对对象的深度监听\n  \t\t\n      Lazy - 和Vue2.x immediate 正好相反\n  \t\n          类型:Boolean, default:false")])])])])])])}),[],!1,null,null,null);s.default=e.exports}}]);